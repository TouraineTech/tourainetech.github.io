---
import { siteConfig } from '@data/config/site';
import sponsors from '@data/sponsors.yaml';

const { isSponsoringOpen } = siteConfig;

// Filter sponsors by tier (Gold > Silver > Bronze)
const goldSponsors = sponsors.filter((s: any) => s.type === 'gold');
const silverSponsors = sponsors.filter((s: any) => s.type === 'silver');
const bronzeSponsors = sponsors.filter((s: any) => s.type === 'bronze');

const hasSponsors = goldSponsors.length > 0 || silverSponsors.length > 0 || bronzeSponsors.length > 0;
---

{isSponsoringOpen && (
<section class="sponsors-preview">
  <div class="sponsors-preview-inner">
    <div class="section-header">
      <span class="section-label">Sponsors</span>
      <h2 class="section-title">Ils nous soutiennent</h2>
      <p class="section-desc">
        Merci à nos sponsors qui rendent cet événement possible
      </p>
    </div>

    {hasSponsors ? (
      <div class="sponsors-tiers">
        {/* Gold Tier - Premium showcase */}
        {goldSponsors.length > 0 && (
          <div class="tier tier-gold">
            <div class="tier-header">
              <span class="tier-badge tier-badge-gold">
                <svg viewBox="0 0 24 24" fill="currentColor" width="14" height="14">
                  <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                </svg>
                Gold
              </span>
            </div>
            <div class="sponsors-grid sponsors-grid-gold">
              {goldSponsors.map((sponsor: any) => (
                <a
                  href={sponsor.link}
                  target="_blank"
                  rel="noopener"
                  class="sponsor-card sponsor-card-gold"
                  title={sponsor.name}
                >
                  <div class="card-shimmer"></div>
                  <div class="sponsor-logo">
                    <img
                      src={`/img/sponsors/${sponsor.image}`}
                      alt={sponsor.name}
                      loading="lazy"
                    />
                  </div>
                  <span class="sponsor-name">{sponsor.name}</span>
                </a>
              ))}
            </div>
          </div>
        )}

        {/* Silver Tier - Solid support */}
        {silverSponsors.length > 0 && (
          <div class="tier tier-silver">
            <div class="tier-header">
              <span class="tier-badge tier-badge-silver">
                <svg viewBox="0 0 24 24" fill="currentColor" width="12" height="12">
                  <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                </svg>
                Silver
              </span>
            </div>
            <div class="sponsors-grid sponsors-grid-silver">
              {silverSponsors.map((sponsor: any) => (
                <a
                  href={sponsor.link}
                  target="_blank"
                  rel="noopener"
                  class="sponsor-card sponsor-card-silver"
                  title={sponsor.name}
                >
                  <div class="sponsor-logo">
                    <img
                      src={`/img/sponsors/${sponsor.image}`}
                      alt={sponsor.name}
                      loading="lazy"
                    />
                  </div>
                  <span class="sponsor-name">{sponsor.name}</span>
                </a>
              ))}
            </div>
          </div>
        )}

        {/* Bronze Tier - Compact logos */}
        {bronzeSponsors.length > 0 && (
          <div class="tier tier-bronze">
            <div class="tier-header">
              <span class="tier-badge tier-badge-bronze">
                <svg viewBox="0 0 24 24" fill="currentColor" width="10" height="10">
                  <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                </svg>
                Bronze
              </span>
            </div>
            <div class="sponsors-grid sponsors-grid-bronze">
              {bronzeSponsors.map((sponsor: any) => (
                <a
                  href={sponsor.link}
                  target="_blank"
                  rel="noopener"
                  class="sponsor-logo-only"
                  title={sponsor.name}
                >
                  <img
                    src={`/img/sponsors/${sponsor.image}`}
                    alt={sponsor.name}
                    loading="lazy"
                  />
                </a>
              ))}
            </div>
          </div>
        )}
      </div>
    ) : (
      <div class="sponsors-empty">
        <p>Les sponsors seront annoncés prochainement</p>
      </div>
    )}

    <div class="sponsors-footer">
      <a href="/sponsors" class="btn btn-secondary">
        Voir tous nos sponsors
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 12h14M12 5l7 7-7 7"/>
        </svg>
      </a>
    </div>
  </div>
</section>
)}

<style>
  .sponsors-preview {
    padding: var(--section-padding);
    background: var(--bg-primary);
  }

  .sponsors-preview-inner {
    max-width: 1200px;
    margin: 0 auto;
  }

  .sponsors-tiers {
    display: flex;
    flex-direction: column;
    gap: 2.5rem;
  }

  /* Tier Header */
  .tier-header {
    display: flex;
    justify-content: center;
    margin-bottom: 1.25rem;
  }

  .tier-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.4rem 1rem;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    border-radius: 100px;
  }

  .tier-badge-gold {
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    color: #1a1a2e;
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
  }

  .tier-badge-silver {
    background: linear-gradient(135deg, #E8E8E8 0%, #C0C0C0 100%);
    color: #1a1a2e;
  }

  .tier-badge-bronze {
    background: linear-gradient(135deg, #CD7F32 0%, #A0522D 100%);
    color: white;
  }

  /* Sponsors Grid */
  .sponsors-grid {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1.5rem;
  }

  /* Gold Cards - Premium */
  .sponsor-card-gold {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    padding: 2rem 2.5rem;
    background: white;
    border: 2px solid #DAA520;
    border-radius: 20px;
    text-decoration: none;
    transition: all 0.3s ease;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.15);
  }

  .sponsor-card-gold:hover {
    transform: translateY(-6px);
    box-shadow: 0 8px 35px rgba(255, 215, 0, 0.35);
    border-color: #FFD700;
  }

  .sponsor-card-gold:focus-visible,
  .sponsor-card-silver:focus-visible,
  .sponsor-logo-only:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  .sponsor-card-gold .sponsor-logo img {
    max-height: 80px;
    max-width: 200px;
    object-fit: contain;
  }

  .sponsor-card-gold .sponsor-name {
    font-weight: 600;
    font-size: 1rem;
    color: var(--text-primary);
  }

  /* Gold Shimmer Effect */
  .card-shimmer {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(255, 215, 0, 0.08) 50%,
      transparent 100%
    );
    background-size: 200% 100%;
    animation: shimmer 4s ease-in-out infinite;
    pointer-events: none;
  }

  @keyframes shimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  /* Silver Cards - Elegant */
  .sponsor-card-silver {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    padding: 1.5rem 2rem;
    background: var(--bg-secondary);
    border: 1px solid #C0C0C0;
    border-radius: 16px;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .sponsor-card-silver:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
    border-color: #A0A0A0;
    background: white;
  }

  .sponsor-card-silver .sponsor-logo img {
    max-height: 60px;
    max-width: 160px;
    object-fit: contain;
  }

  .sponsor-card-silver .sponsor-name {
    font-weight: 500;
    font-size: 0.9rem;
    color: var(--text-secondary);
  }

  /* Bronze - Compact logos only */
  .sponsors-grid-bronze {
    gap: 1rem;
  }

  .sponsor-logo-only {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.75rem 1.25rem;
    background: var(--bg-tertiary);
    border-radius: 10px;
    transition: all 0.3s ease;
  }

  .sponsor-logo-only img {
    max-height: 40px;
    max-width: 100px;
    object-fit: contain;
    filter: grayscale(100%);
    opacity: 0.7;
    transition: all 0.3s ease;
  }

  .sponsor-logo-only:hover {
    background: var(--bg-secondary);
    transform: translateY(-2px);
  }

  .sponsor-logo-only:hover img {
    filter: grayscale(0%);
    opacity: 1;
  }

  /* Empty state */
  .sponsors-empty {
    text-align: center;
    padding: 3rem;
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    border: 1px dashed var(--glass-border);
  }

  .sponsors-empty p {
    color: var(--text-muted);
    font-size: 1rem;
  }

  /* Footer */
  .sponsors-footer {
    display: flex;
    justify-content: center;
    margin-top: 2.5rem;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .sponsors-grid {
      gap: 1rem;
    }

    .sponsor-card-gold {
      padding: 1.5rem 2rem;
    }

    .sponsor-card-gold .sponsor-logo img {
      max-height: 60px;
      max-width: 150px;
    }

    .sponsor-card-silver {
      padding: 1rem 1.5rem;
    }

    .sponsor-card-silver .sponsor-logo img {
      max-height: 45px;
      max-width: 120px;
    }

    .sponsor-logo-only img {
      max-height: 30px;
      max-width: 80px;
    }
  }

  @media (max-width: 480px) {
    .sponsors-grid-bronze {
      gap: 0.5rem;
    }

    .sponsor-logo-only {
      padding: 0.5rem 0.75rem;
    }
  }
</style>
